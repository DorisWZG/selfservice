
{% extends "budget_allocation/base.html" %}

    {% load staticfiles %}

    {% block title %}Glogou Product and Service{% endblock %}
    {% block description %}{% endblock %}
    {% block keyword %}{% endblock %}


    {% block content %}

    <!-- Page Content -->
     <nav class="navbar navbar-default">
        <div class="container">
            <form class="navbar-form navbar-left">
                <div class="form-group">
                    <label class="sr-only" for="selectCategory">Category</label>
                    <select id="selectCategory" class="form-control" onchange="getSubCategory()">
                        <option value=""> Business sector... </option>
                        <!--
                        <option value="1"> Education Market </option>
                        <option value="2"> Destination Marketing </option>
                        <option value="3"> Real Estate </option>
                        <option value="4"> High Tech industry </option>
                        -->

                    </select>
                </div>
                <div class="form-group">
                    <label class="sr-only" for="selectSubCategory">SubCategory</label>
                    <select id="selectSubCategory" class="form-control">
                        <option value="">Sub business sector...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="sr-only" for="selectGoal">Campaign Goal</label>
                    <select id="selectGoal" class="form-control">
                        <option value="">Please select the Campaign goal</option>
                        <option value="click">I want to get more clicks after campaign</option>
                        <option value="impression">I want to get more impressions after campaign</option>
                    </select>
                </div>
                <div class="form-group">
                    {#<a class="btn btn-primary" onclick="showResult();">See Result <span class="glyphicon glyphicon-chevron-right"></span></a>#}
                    <a id="see_result_button" class="btn btn-primary" onclick="showResultPage();"><span class="glyphicon glyphicon-search"></span></a>
                </div>
            </form>
        </div>
    </nav>
    <div class="container">

        <!-- Page Heading -->
        <div class="row">
            <div class="col-lg-6">
                <h1 class="page-header" >Recommended Media Channels for: <br>
                    <small >Selected Industry: {{ category_name | title }} <br>
                    Selected Sub Industry: {{ subcategory_name | title}}</small>
                </h1>
            </div>
            <div class="col-md-6">
                <img class="banner img-responsive img-portfolio img-hover" src="/static/images/puzzle-csd.jpg">
            </div>

        </div>


        <div class="row col-lg-6">
        {% if metrics_result %}
        <table class="table table-striped" id="result-table">

            <tr>
            {% for item in metrics_result %}
                <th><a href="{{ item.channelId.channelUrl }}" data-toggle="tooltip"
                       data-placement="right" title="{{ item.channelId.channelDescription }}">
                    {{ item.channelId.channelName }}</a></th>
            {% endfor %}
            </tr>
            <tr>
            {% for item in metrics_result %}
                {% widthratio item.budgetPercentage 1 100 as percentage%}
                <td>{{ percentage }} %</td>
            {% endfor %}
            </tr>
        </table>
        {% endif %}
        </div>



        <!-- /.     row -->
        <div class="row hidden">
            {% if metrics_result %}
            <table class="table table-striped" id="result-table-old">
                <tr>
                    <th>Suggested Channel</th>
                    <th>Budget Percentage</th>
{#                    <th>Budget Allocation</th>#}
{#                    <th>Expected Clicks</th>#}
{#                    <th>Average Cost per Click</th>#}
{#                    <th>Expected Impressions</th>#}
{#                    <th>Average Cost per Impression</th>#}
                </tr>
                {% for item in metrics_result %}
                    <tr>
                        <td><a href="{{ item.channelId.channelUrl }}" data-toggle="tooltip" data-placement="right" title="{{ item.channelId.channelDescription }}">{{ item.channelId.channelName }}</a></td>
                        <td>{{ item.budgetPercentage }}</td>
{#                        <td>{{ item.expectedClicks }}</td>#}
{#                        <td>{{ item.costPerClick }}</td>#}
{#                        <td>{{ item.expectedImpressions }}</td>#}
{#                        <td>{{ item.costPerImpression }}</td>#}
                    </tr>
                {% endfor %}
            </table>
            {% endif %}
        </div>
        <div class="row">
        </div>
        <div class="row col-lg-12">
            {% if metrics_result %}
                {% for item in metrics_result %}
                    <table class="table table-bordered" id="result-table">

                        <tr>
                            <th class="col-md-2" bgcolor="#e6e6fa">Suggested Channel</th>

                            {% if item.campaignGoal == "CPC" %}
                                <th class="col-md-3" bgcolor="#e6e6fa">Average CPC($)</th>
                                <th class="col-md-3" bgcolor="#e6e6fa">Average CPC(RMB)</th>
                                <th class="col-md-2" bgcolor="#e6e6fa">Number of Clicks</th>
                            {% else %}
                                <th class="col-md-3" bgcolor="#e6e6fa">Average CPM($)</th>
                                <th class="col-md-3" bgcolor="#e6e6fa">Average CPM(RMB)</th>
                            {% endif %}
                            <th class="col-md-2" bgcolor="#e6e6fa">Minimum Budget</th>
                        </tr>
                        <tr>
                            <td>{{ item.channelId.channelName }}</td>
                            <hr>
                            {% if item.costPerClick %}
                                <td>&dollar; {{ item.costPerClick }}</td>
                            {% else %}
                                <td>N/A</td>
                            {% endif %}

                            {% if item.costPerClick %}
                                {% widthratio item.costPerClick 1 6 as costPerClickRMB%}
                                <td>&yen; {{ costPerClickRMB }}</td>
                            {% else %}
                                <td>N/A</td>
                            {% endif %}

                            {% if item.campaignGoal == "CPC" %}
                                {% if item.expectedClicks %}
                                    <td>item.expectedClicks</td>
                                {% else %}
                                    <td>N/A</td>
                                {% endif %}
                            {% endif %}
                            <td>{{ item.channelId.minMediaBuy }}</td>
                        </tr>

                    </table>
                {% endfor %}
            {% endif %}

            <div class="well">
                <div class="row">
                    <div class="col-md-8">
                        <h4>Please contact us if you are interested for the self service.</h4>
                    </div>
                    <div class="col-md-4" style="float: right">
                        <a class="=btn btn-lg btn-info btn-block" href="/contact">Contact Now !</a>
                    </div>
                </div>
            </div>
        </div>
        {#            <div style="float: left"><a class="btn btn-primary" href="/budget_allocation/stage2_test/">#}
        {#                <span class="glyphicon glyphicon-chevron-left"></span>Back</a></div>#}
        {#        </div>#}
    </div>


    <script src="{% static 'javascript/testGetResult.js' %}"></script>
    <script>
    var url = "/budget_allocation/get_industryNameList";
    $.get(url).done(function(data) {
        var selectElem = $("#selectCategory");
{#        $(data).each(function(idx, category) {#}
{#            $("<option></option>").attr("value", category.industryName).html(category.industryName).appendTo(selectElem)#}
{#        });#}
        $(data).each(function(idx, category) {
            transIndustryName = translateCategory(category.industryName);
            $("<option></option>").attr("value", category.industryName).html(transIndustryName).appendTo(selectElem)
        });
    }).fail(function(data) {
        alert("Status Code: " + data.status + ", Status Text: " + data.statusText + ", Response Text: " + data.responseText);
    });
    </script>
    {% endblock %}